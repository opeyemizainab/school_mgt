{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2 class="mb-4">Promote Students</h2>

    <!-- Select From Class -->
    <form method="get" action="" class="mb-4">
        <label for="from_class"><strong>From Class:</strong></label>
        <select name="from_class" id="from_class" class="form-control d-inline-block w-auto" onchange="this.form.submit()">
            <option value="">Select Class</option>
            {% for cls in classes %}
                <option value="{{ cls.id }}" {% if from_class_id|default:'' == cls.id|stringformat:'s' %}selected{% endif %}>
                    {{ cls.name }}
                </option>
            {% endfor %}
        </select>
    </form>

    {% if students %}
    <form method="post" class="mt-4">
        {% csrf_token %}

        <!-- Select To Class -->
        <label for="to_class"><strong>To Class:</strong></label>
        <select name="to_class" id="to_class" class="form-control d-inline-block w-auto" required>
            <option value="">Select Class</option>
            {% for cls in classes %}
                {% if cls.id != from_class_id %}
                    <option value="{{ cls.id }}" {% if to_class_id|default:'' == cls.id|stringformat:'s' %}selected{% endif %}>
                        {{ cls.name }}
                    </option>
                {% endif %}
            {% endfor %}
            <option value="graduate">ðŸŽ“ Graduate</option>
        </select>

        <!-- Students Table -->
        <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
                <thead class="thead-dark">
                    <tr>
                        <th>Select</th>
                        <th>Student Name</th>
                        <th>Current Class</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td><input type="checkbox" name="students" value="{{ student.id }}"></td>
                        <td>{{ student.user.get_full_name }}</td>
                        <td>{{ student.classroom.name }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <button type="submit" class="btn btn-primary mt-3">Promote Selected Students</button>
    </form>
    {% elif from_class_id %}
        <p class="mt-3 text-danger">No students found in the selected class.</p>
    {% endif %}
</div>
{% endblock %}
